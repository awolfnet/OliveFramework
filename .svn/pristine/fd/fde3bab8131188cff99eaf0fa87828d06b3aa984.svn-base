using OliveFramework.tool;
using System;
using System.Collections.Generic;
using System.Web;

namespace OliveFramework
{
    public class SystemConfig
    {
        private static string _WindowTitle;
        private static string _DefaultLanguage;
        private static string _LanguageFilePath;
        private static int _TokenValidDay;
        private static string _AppDomainAppPath;
        private static int _MessagePullingTimeout;
        private static int _MessagePullingSleep;
        private static string _WebappURL;
        private static string _AdUploadPath;

        /// <summary>
        /// 窗口标题
        /// </summary>
        public static string WindowTitle
        {
            get
            {
                _WindowTitle = Controller.Configure.Instance.getString("windowtitle");
                return _WindowTitle;
            }
        }

        /// <summary>
        /// 默认语言
        /// </summary>
        public static string DefaultLanguage
        {
            get
            {
                _DefaultLanguage = Controller.Configure.Instance.getString("lang");
                return _DefaultLanguage;
            }
        }

        /// <summary>
        /// 语言文件
        /// </summary>
        public static string LangugeFilePath
        {
            get
            {
                _LanguageFilePath= Controller.Configure.Instance.getString("langfilepath");
                if(_LanguageFilePath==null)
                {
                    _LanguageFilePath = "/language/zh-cn.xml";
                }
                return _LanguageFilePath;
            }
        }

        /// <summary>
        /// Token有效期
        /// </summary>
        public static int TokenValidDay
        {
            get
            {
                int? validday=Controller.Configure.Instance.getInt("validday");
                if(validday==null)
                {
                    _TokenValidDay = 1;
                }else
                {
                    _TokenValidDay = (int)validday;
                }
                return _TokenValidDay;
            }
        }

        /// <summary>
        /// 网站物理路径
        /// </summary>
        public static string AppDomainAppPath
        {
            get
            {

                if (Controller.Configure.Instance.isSet("webpath"))
                {
                    _AppDomainAppPath = Controller.Configure.Instance.getString("webpath");
                }
                else
                {
                    _AppDomainAppPath = HttpRuntime.AppDomainAppPath;
                }
                return _AppDomainAppPath;
            }
        }

        /// <summary>
        /// 消息轮询超时（秒）
        /// </summary>
        public static int MessagePullingTimeout
        {
            get
            {
                if (Controller.Configure.Instance.isSet("message_pulling_timeout"))
                {
                    int? messgePullingTimeout = Controller.Configure.Instance.getInt("message_pulling_timeout");
                    if (messgePullingTimeout != null)
                    {
                        _MessagePullingTimeout = (int)messgePullingTimeout;
                    }else
                    {
                        _MessagePullingTimeout = 10;
                    }
                }else
                {
                    _MessagePullingTimeout = 10;
                }


                return _MessagePullingTimeout;
            }
            
        }

        /// <summary>
        /// 消息轮询间隔（毫秒）
        /// </summary>
        public static int MessagePullingSleep
        {
            get
            {
                if (Controller.Configure.Instance.isSet("message_pulling_sleep"))
                {
                    int? messgePullingSleep = Controller.Configure.Instance.getInt("message_pulling_sleep");
                    _MessagePullingSleep = (int)messgePullingSleep;
                }
                else
                {
                    _MessagePullingSleep = 500;
                }


                return _MessagePullingSleep;
            }
        }

        /// <summary>
        /// 网站程序URL
        /// </summary>
        public static string WebappURL
        {
            get
            {
                string weburl;
                string webalias;

                if(Controller.Configure.Instance.isSet("weburl"))
                {
                    weburl = Controller.Configure.Instance.getString("weburl");
                    if(!weburl.EndsWith("/"))
                    {
                        weburl += "/";
                    }
                }else
                {
                    weburl = "http://localhost/";
                }

                if(Controller.Configure.Instance.isSet("webalias"))
                {
                    webalias = Controller.Configure.Instance.getString("webalias");
                    if(!webalias.EndsWith("/"))
                    {
                        webalias += "/";
                    }
                }
                else
                {
                    webalias = "OliveFramework/";
                }

                _WebappURL = weburl + webalias;
                return _WebappURL;
            }
        }

        /// <summary>
        /// 广告图片上传路径
        /// </summary>
        public static string AdUploadPath
        {
            get
            {
                if(Controller.Configure.Instance.isSet("aduploadpath"))
                {
                    _AdUploadPath = Controller.Configure.Instance.getString("aduploadpath");
                    if(!_AdUploadPath.EndsWith("/"))
                    {
                        _AdUploadPath += "/";
                    }
                }
                return _AdUploadPath;
            }
        }


    }
}